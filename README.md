# Yatube

## _Проект Yatube — это платформа для публикаций, блог. Она даёт пользователям возможность создать учетную запись, публиковать записи, подписываться на любимых авторов и коментировать записи. Имеется возможность модерировать записи и блокировать пользователей._

Создано и зарегистрировано приложение *Posts* для управления записями.
Подключена база данных.
В админ-зоне доступно управление объектами модели *Post*: можно публиковать новые записи или редактировать/удалять существующие.
Пользователь может перейти на страницу любого сообщества, где отображаются десять последних публикаций из этой группы.

Настроен эмулятор отправки писем; отправленные письма сохраняются в виде текстовых файлов в директорию _/sent_emails_. Настроена отправка письма при восстановлении пароля. 
Создано и подключено приложение *core*. В нём
- размещён и зарегистрирован фильтр _addclass_, позволяющий добавлять CSS-класс к тегу шаблона.
- создан и зарегистрирован контекст-процессор, добавляющий текущий год на все страницы в переменную {{ year }}.

Создано и подключено приложение *about*, в нём
- созданы статические страницы _/about/author/_ и _/about/tech/_.
- ссылки на эти страницы добавлены в навигацию сайта.

Для всех путей установлены _name_ и _namespace_.
Подключено приложение *django.contrib.auth*, его _urls.py_ подключен к головному _urls.py_.
Создано и подключено приложение users, в нём
    1. Переопределены шаблоны для адресов
       - _/auth/login/_ (авторизация),
       - _/auth/logout/_ (выход из аккаунта).
    2. Создана страница _/auth/signup/_ с формой для регистрации пользователей.

В приложении *posts*
    1. Создана страница пользователя _profile/<username>/_. На ней отображаются посты пользователя.
    2. Создана отдельная страница поста _posts/<post_id>/_.
    3. Подключен паджинатор, он выводит по десять постов 
       - на главную страницу,
       - на страницу профайла,
       - на страницу группы.

Создана страница с формой для публикации постов.
    1. В шапку сайта добавлена ссылку «Новая запись», она видна только авторизованным пользователям и ведет на страницу _/create/_
    2. После валидации формы и создания нового поста автора перенаправляет на страницу своего профайла _/profile/<username>/_.

Создана страница редактирования постов с адресом _/posts/<post_id>/edit/_. 
Права на редактирование только у автора этого поста. Остальные пользователи перенаправляются на страницу просмотра поста.
Для страницы редактирования поста применяется переработанный-шаблон страницы создания нового поста: _posts/create_post.html_. 
- при редактировании поста заголовок «Добавить запись» заменяется на «Редактировать запись»;
- надпись на кнопке отправки формы тоже зависит от операции: «Добавить» для новой записи и «Сохранить» — для редактирования.
## Тесты
Протестированы модели приложения *posts* с использованием Unitttest.
Проверена доступность страниц и названия шаблонов приложения *posts* проекта. Проверка учитывает права доступа. 
Проверено, что запрос к несуществующей странице вернёт ошибку 404.

| URL | Права доступа | Используемый шаблона |
| ------ | ------ | ------ |
| / | Всем | posts/index.html |
| /group/<slug>/ | Всем | posts/group_list.html |
| profile/<username>/ | Всем | posts/profile.html |
| posts/<post_id>/ | Всем | posts/post_detail.html |
| posts/<post_id>/edit/ | Автору | posts/create_post.html |
| create/ | Авторизованному | posts/create_post.html |
| unexisting_page/ | Всем | |

Написаны тесты, проверяющие, что во view-функциях используются правильные html-шаблоны.
| Шаблон | Reverse |
| ------ | ------ |
| posts/index.html | posts:index |
| posts/group_list.html | posts:group_list |
| posts/profile.html | posts:profile |
| posts/post_detail.html | posts:post_detail |
| posts/create_post.html | posts:post_edit |
| posts/create_post.html | posts:create_post |

Проверено, соответствует ли ожиданиям словарь context, передаваемый в шаблон при вызове. Протестирован пажинатор.
| Reverse | Ожидаемый контекст |
| ------ | ------ |
| posts/index.html | список постов |
| posts/group_list.html | список постов отфильтрованный по группе |
| posts/profile.html | список постов отфильтрованный по пользователю |
| posts/post_detail.html | один пост, отфильтрованный по id |
| posts/create_post.html | форма редактирования поста, отфильтрованного по id |
| posts/create_post.html | форма создания поста |

Проверено, что если при создании поста указать группу, то этот пост появляется 
- на главной странице сайта,
- на странице выбранной группы,
- в профайле пользователя.

Проверено, что этот пост не попал в группу, для которой не был предназначен.
В проекте написаны тесты, которые проверяют, что
- при отправке валидной формы со страницы создания поста _reverse('posts:create_post')_ создаётся новая запись в базе данных;
- при отправке валидной формы со страницы редактирования поста _reverse('posts:post_edit', args=('post_id',))_ происходит изменение поста с post_id в базе данных.

При выводе поста с картинкой изображение передаётся в словаре context 
- на главную страницу,
- на страницу профайла,
- на страницу группы,
- на отдельную страницу поста;

При отправке поста с картинкой через форму *PostForm* создаётся запись в базе данных.
Подобным образом протестированны приложения *users* и *about*.
## Добавлены кастомные страницы ошибок:
- 404 page_not_found
- 500 server_error
- 403 permission_denied_view
Написан тест, проверяющий, что страница 404 отдает кастомный шаблон.
## С помощью sorl-thumbnail выведены иллюстрации к постам: 
- в шаблон главной страницы,
- в шаблон профайла автора,
- в шаблон страницы группы,
- на отдельную страницу поста.
## Создана система комментариев
Написана система комментирования записей. На странице поста под текстом записи выводится форма для отправки комментария, а ниже — список комментариев. Комментировать могут только авторизованные пользователи. Работоспособность модуля протестирована.
## Кеширование главной страницы
Список постов на главной странице сайта хранится в кэше и обновляется раз в 20 секунд.
## Тестирование кэша
Написан тест для проверки кеширования главной страницы.
## Подписки на авторов
Добавлена система подписки на авторов и создана лента их постов.
